import{persist as e}from"../core/index.js";import{nil as t}from"../nil/index.js";var a,r,o=Symbol(),i=new Map,n=e=>location.pathname+(e+""?"?"+e:"")+(location.hash&&"#"!==location.hash?location.hash:""),s=(e,t)=>history.pushState(t?null:history.state,"",n(e)),l=(e,t)=>history.replaceState(t?null:history.state,"",n(e)),c=e=>location.assign(n(e)),u=e=>location.replace(n(e));function d(e,t){if(r=void 0,i.size){var a=new URLSearchParams(location.search);for(var[o,n]of i.entries())null!=n?a.set(o,`${n}`):a.delete(o);i.clear(),e(a,"erase"===t)}}function f(e){return"undefined"!=typeof history&&"undefined"!=typeof location?function({method:e=s,state:t,serialize:n,deserialize:l,def:c=null,timeout:u}){var f=(o,s)=>("undefined"!=typeof addEventListener&&addEventListener("popstate",(()=>setTimeout(s,0))),{get(){var e=new URLSearchParams(location.search).get(o);return e?l?l(e):e:c},set(s){if(i.set(o,n?n(s):s),void 0===u)return clearTimeout(a),d(e,t);var l=Date.now()+u;(void 0===r||r>l)&&(clearTimeout(a),r=l,a=setTimeout(d,u,e,t))}});return f.keyArea=o,f}({...e}):t({keyArea:"query"})}function h(t){return a=>e({adapter:f,...t,...a})}f.factory=!0;var p=h();export{h as createPersist,c as locationAssign,u as locationReplace,p as persist,s as pushState,f as query,l as replaceState};
//# sourceMappingURL=index.js.map
